!function(){"use strict";String.prototype.camelCaseToNormalText=function(){return this.replace(/([A-Z])/g," $1").replace(/^./,function(a){return a.toUpperCase()})},angular.module("uiTreeGrid",[]),angular.module("uiTreeGrid").value("uiGridConfig",{}),angular.module("uiTreeGrid").directive("uiGrid",["uiGridConfig","Util",function(a,b){var c={};return a&&angular.extend(c,a),{restrict:"A",replace:!0,templateUrl:"grid.html",scope:!0,link:function(a,c,d){a.columns=a.$eval(d.columns),a.data=a.$eval(d.data),a.searchText=a.$eval(d.searchText),a.selectRow=a.$eval(d.selectRow),a.controller=a.$eval(d.controller),a.childrenNode=d.childrenNode||"children",a.fixedHeader=d.fixedHeader,a.iconTemplate=d.iconTemplate,a.treeData=[],a.predicate="",a.reverse=!1,a.fixedHeader&&angular.element(c).bind("scroll",function(b){this.querySelector(".tg-header").style.top=b.target.scrollTop+"px",a.$apply()}),b.isEmpty(a.data.$promise)&&(a.data.$promise={then:function(b){b(a.data)}}),b.isEmpty(a.columns)&&a.data.$promise.then(function(c){a.columns=b.generateColumnsByData(c,a.childrenNode)}),a.data.$promise.then(function(c){a.treeData=b.generate(b.sort(c,a.predicate,a.reverse),1)}),a.sort=function(c,d){a.predicate=c,a.reverse=!d,a.treeData=b.generate(b.sort(a.data,a.predicate,a.reverse),1)},a.isVisibleIcon=function(c){return c>0?!1:!b.isUndefined(a.iconTemplate)},a.clickRow=function(c,d){return b.isEmpty(a.selectRow)?!1:void a.selectRow(c,d)},a.get=function(a,c){return b.deepFind(c,a)},a.$watch("searchText",function(c){a.treeData=[];var d=b.filter(a.data,c),e=b.sort(d,a.predicate,a.reverse);a.treeData=b.generate(e,1)}),a.$watch("data",function(c){a.treeData=[],a.treeData=b.generate(c)},!0),angular.element(c.find("div")[1]).bind("scroll",function(){c.find("div")[0].style.left=-1*this.scrollLeft+"px"}),d.$observe("iconTemplate",function(b){a.iconTemplate=b})}}}]),angular.module("uiTreeGrid").service("Util",["$filter",function(a){this.isUndefined=function(a){return"undefined"==typeof a},this.isEmpty=function(a){return"undefined"==typeof a||null===a||""===a},this.generate=function b(a,c,d){d=d||[],c=c||1;var e=angular.copy(a);return(e||[]).forEach(function(a){a.lvl=c,d.push(a),b(a.children,c+1,d),delete a.children}),d},this.filter=function c(b,d){var e=angular.copy(b);return(e||[]).forEach(function(a){a.children=c(a.children,d)}),a("filter")(e,d)},this.sort=function d(b,c,e){var f=angular.copy(b);return(f||[]).forEach(function(a){a.children=d(a.children,c,e)}),a("orderBy")(f,c,e)},this.generateColumnsByData=function(a,b){var c=[];return Object.keys(a[0]).forEach(function(a){return a===b?!1:void c.push({id:a,label:a.camelCaseToNormalText()})}),c},this.deepFind=function(a,b){var c,d=b.split("."),e=a;for(c=0;c<d.length;++c){if(void 0===e[d[c]])return void 0;e=e[d[c]]}return e}}]),angular.module("uiTreeGrid").run(["$templateCache",function(a){a.put("grid.html",'<div class="ui-tree-grid bordered"><div class=tg-content-table><div class="tg-header tg-row"><div class="tg-column tg-size-{{column.size||3}}" ng-repeat="column in columns" ng-click="sort(column.id, reverse);">{{column.label}} <span ng-class="{true: \'fa fa-sort-asc\', false: \'fa fa-sort-desc\'}[reverse]" ng-if="column.id == predicate"></span></div></div><div class=tg-body><div ng-repeat="row in treeData" class=tg-row><div class="tg-column tg-lvl-{{row.lvl}} tg-size-{{column.size||3}}" ng-repeat="column in columns" ng-click="clickRow(row, $index);"><span ng-if=isVisibleIcon($index) class=icon-template ng-include=iconTemplate></span> {{get(column.id, row)}}</div></div></div></div></div>')}])}(window);